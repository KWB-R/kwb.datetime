<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exkurs Zeitzonen • kwb.datetime</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exkurs Zeitzonen">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.datetime</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/timezones.html">Exkurs Zeitzonen</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kwb-r/kwb.datetime">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Exkurs Zeitzonen</h1>
                        <h4 class="author">Hauke Sonnenberg</h4>
            
            <h4 class="date">2019-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwb-r/kwb.datetime/blob/master/vignettes/timezones.Rmd"><code>vignettes/timezones.Rmd</code></a></small>
      <div class="hidden name"><code>timezones.Rmd</code></div>

    </div>

    
    
<p><code>POSIXct</code>-Objekte haben eine Zeitzone als Attribut gespeichert:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">now &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2019-04-08 12:34:56"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(now)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; [1] "POSIXct" "POSIXt" </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; $tzone</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; [1] ""</span></a></code></pre></div>
<p>Wenn, wie hier, keine Zeitzone angegeben ist (<code>tzone = ""</code>) , wird diejenige angenommen, die auf dem Rechner eingestellt ist. Diese kann wie folgt ermittelt werden:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/timezones">Sys.timezone</a></span>()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [1] "Europe/Berlin"</span></a></code></pre></div>
<p>Das sollte bei Ihnen die Zeitzone “Europe/Berlin” sein. In dieser Zeitzone gibt es (noch, die EU hat die Abschaffung der Zeitumstellung beschlossen) eine Umstellung zwischen Sommer- und Winterzeit und umgekehrt. Erst vor kurzem, am 31.03.2019, wurde die Uhr wieder von Winterzeit (bzw. Normalzeit) auf Sommerzeit umgestellt. Wie sieht das in R aus?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">(before_switch &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2019-03-31 01:59:00"</span>))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:59:00 CET"</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># eine Minute spaeter... </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">before_switch <span class="op">+</span><span class="st"> </span><span class="dv">60</span> </a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; [1] "2019-03-31 03:00:00 CEST"</span></a></code></pre></div>
<p>Wir setzen uns mit der Variablen <code>before_switch</code> auf den Zeitpunkt, der eine Minute vor der Zeitumstellung liegt. Geben wir den Zeitpunkt aus, so wird uns angezeigt, dass wir uns in “CET = Central European Time” befinden. Eine Minute, also 60 Sekunden später ist es bereits 03:00 Uhr, da die Uhr um 02:00 auf 03:00 vorgestellt wird. Es wird angezeigt, dass wir uns nun in “CEST = Central European Summer Time” befinden.</p>
<p><strong>Achtung</strong>: Wenn ein Zeitstempel angegeben wird, der in der gegebenen Zeitzone nicht exisitert, passieren unerwartete Dinge. Das muss unbedingt beachtet werden, wenn mit Zeitreihen gearbeitet wird! Zum Beispiel existieren in der Zeitzone “Europe/Berlin” diejenigen Zeitstempel nicht, die am Tag der Umstellung auf Sommerzeit in der Stunde zwischen zwei und drei Uhr morgens liegen (genauer die Zeitstempel zwischen 02:00:01 und 02:59:59). Zum Beispiel gibt es an diesem Tag nicht die Uhrzeit “halb drei”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">(non_existing_time &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2019-03-31 02:30:00"</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:30:00 CET"</span></a></code></pre></div>
<p>Welche Zeit wird hier angezeigt? Das scheint vom Betriebssystem abzuhängen! Auf meinem Ubuntu-Rechner wird die Uhrzeit um eine Stunde zurückgesetzt und es wird “2019-03-31 01:30:00 CET” angezeigt. In Windows hingegen würde die Uhrzeit einfach “abgeschnitten”, also intern auf “00:00:00” gesetzt und entsprechend “2019-03-31 CET” angezeigt.</p>
<p>Um die Zeitumstellung zu unterbinden “zwinge” ich R gerne dazu, die Zeitzone “UTC” (Coordinated Universal Time) zu verwenden. Dazu:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">(before_switch &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2019-03-31 01:59:00"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:59:00 UTC"</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># eine Minute spaeter... </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">(after_switch &lt;-<span class="st"> </span>before_switch <span class="op">+</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; [1] "2019-03-31 02:00:00 UTC"</span></a></code></pre></div>
<p>Die Zeitzone ist und bleibt “UTC”. Das Attribut “tzone” ist entsprechend auf “UTC” gesetzt.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(before_switch)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; [1] "POSIXct" "POSIXt" </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; $tzone</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [1] "UTC"</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(after_switch)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; $tzone</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; [1] "UTC"</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [1] "POSIXct" "POSIXt"</span></a></code></pre></div>
<p>Ich habe sehr lange gebraucht, bis ich herausgefunden habe, wie ich in R angeben kann, dass ich zwar in Berlin bin, aber keine Umstellung von Sommer- auf Winterzeit vornehme. Wir versuchen zum Beispiel unsere Messgeräte so einzustellen, dass sie den Zeitstempel immer in Normalzeit (Winterzeit) aufzeichnen und die Uhr weder vor- noch zurückstellen. Wir tun dies, um zu vermeiden, dass doppelte Zeitstempel, nämlich in der Stunde, in der die Uhr von Sommer- auf Winterzeit zurückgestellt wird, zu vermeiden.</p>
<p>Der entscheidende Hinweis findet sich in der Hilfe zu “timezones”:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/help">help</a></span>(<span class="st">"timezones"</span>)</a></code></pre></div>
<blockquote>
<p>“Most platforms support time zones of the form Etc/GMT+n and Etc/GMT-n (possibly also without prefix Etc/), which assume a fixed offset from UTC (hence no DST). Contrary to some expectations (but consistent with names such as PST8PDT), negative offsets are times ahead of (east of) UTC, positive offsets are times behind (west of) UTC.”</p>
</blockquote>
<p>Um also R mitzuteilen, dass wir in Berlin durchgängig in Winterzeit messen, müssen wir die Zeitzone auf “Etc/GMT-1” stellen.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">(before_switch_normal &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2019-03-31 01:59:00"</span>, <span class="dt">tz =</span> <span class="st">"Etc/GMT-1"</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:59:00 +01"</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">(after_switch_normal &lt;-<span class="st"> </span>before_switch_normal <span class="op">+</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; [1] "2019-03-31 02:00:00 +01"</span></a></code></pre></div>
<p>Um diese zwei Zeitpunkte nun wieder in der Zeitzone “Europe/Berlin” anzeigen zu lassen, nutzen wir die <code><a href="https://www.rdocumentation.org/packages/base/topics/format">format()</a></code> Funktion:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(before_switch_normal, <span class="dt">tz =</span> <span class="st">"Europe/Berlin"</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:59:00"</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(after_switch_normal, <span class="dt">tz =</span> <span class="st">"Europe/Berlin"</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [1] "2019-03-31 03:00:00"</span></a></code></pre></div>
<p>Nanu, die Angaben “CET” bzw. “CEST” werden nun nicht mehr angegeben, wie das oben noch der Fall war. Das liegt daran, dass die <code><a href="https://www.rdocumentation.org/packages/base/topics/format">format()</a></code> Funktion diesen Zusatz standardmäßig nicht anzeigt. Wir können die Anzeige wieder erreichen, indem wir (hier nur temporär) das Attribut “tzone” mit Hilfe der Funktion <code><a href="https://www.rdocumentation.org/packages/base/topics/structure">structure()</a></code> wieder auf “Europe/Berlin” setzen:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/structure">structure</a></span>(before_switch_normal, <span class="dt">tzone =</span> <span class="st">"Europe/Berlin"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; [1] "2019-03-31 01:59:00 CET"</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/structure">structure</a></span>(after_switch_normal, <span class="dt">tzone =</span> <span class="st">"Europe/Berlin"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; [1] "2019-03-31 03:00:00 CEST"</span></a></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
